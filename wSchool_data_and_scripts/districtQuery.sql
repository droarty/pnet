/* creates summary for state, state wo cps, 5 regions, and all districts  */
select subj, cdts, rc_cdts, rcdts, scName, diName, county, schType, region, countyCode, uicRegion,
   Count01, Count05, Count06, Count10, Count14, Count15, Count16,
   ethW01, ethW05, ethW06, ethW10, ethW14, ethW15, ethW16,
   ethB01, ethB05, ethB06, ethB10, ethB14, ethB15, ethB16,
   ethL01, ethL05, ethL06, ethL10, ethL14, ethL15, ethL16,
   ethM01, ethM05, ethM06, ethM10, ethM14, ethM15, ethM16,
   lwIncPc01, lwIncPc05, lwIncPc06, lwIncPc10, lwIncPc14, lwIncPc15, lwIncPc16,
   mobRt01, mobRt05, mobRt06, mobRt10, mobRt14, mobRt15, mobRt16,
   LEPPc01, LEPPc05, LEPPc06, LEPPc10, LEPPc14, LEPPc15, LEPPc16,
   AtAbove50Pc01, AtAbove50Pc05, AtAbove50Pc06, AtAbove50Pc10, AtAbove50Pc14, AtAbove50Pc15, AtAbove50Pc16,
   AtAbove60Pc01, AtAbove60Pc05, AtAbove60Pc06, AtAbove60Pc10, AtAbove60Pc14, AtAbove60Pc15, AtAbove60Pc16,
   AtAbove68Pc01, AtAbove68Pc05, AtAbove68Pc06, AtAbove68Pc10, AtAbove68Pc14, AtAbove68Pc15, AtAbove68Pc16,
   PercentileAvg01, PercentileAvg05, PercentileAvg06, PercentileAvg10, PercentileAvg14, PercentileAvg15, PercentileAvg16,
   StanineAvg01, StanineAvg05, StanineAvg06, StanineAvg10, StanineAvg14, StanineAvg15, StanineAvg16,
   ScoreAvg01, ScoreAvg05, ScoreAvg06, ScoreAvg10, ScoreAvg14, ScoreAvg15, ScoreAvg16,
   s1Avg01, s2Avg01, s3Avg01, s4Avg01, s5Avg01, s6Avg01, s7Avg01, s8Avg01, s9Avg01,
   s1Avg06, s2Avg06, s3Avg06, s4Avg06, s5Avg06, s6Avg06, s7Avg06, s8Avg06, s9Avg06,
   s1Avg10, s2Avg10, s3Avg10, s4Avg10, s5Avg10, s6Avg10, s7Avg10, s8Avg10, s9Avg10,
   s1Avg16, s2Avg16, s3Avg16, s4Avg16, s5Avg16, s6Avg16, s7Avg16, s8Avg16, s9Avg16, cdts
from (
   select 'Reading' subj,
   'composite' rc_cdts, 'composite' rcdts, 'State-wide Composite' scName, '' diName, '' county, '' schType, '' region, '' countyCode, '' uicRegion,
   sum(ethW01*Count01)/sum(Count01) ethW01,
   sum(ethW05*Count05)/sum(Count05) ethW05,
   sum(ethW06*Count06)/sum(Count06) ethW06,
   sum(ethW10*Count10)/sum(Count10) ethW10,
   sum(ethW14*Count14)/sum(Count14) ethW14,
   sum(ethW15*Count15)/sum(Count15) ethW15,
   sum(ethW16*Count16)/sum(Count16) ethW16,
   sum(ethB01*Count01)/sum(Count01) ethB01,
   sum(ethB05*Count05)/sum(Count05) ethB05,
   sum(ethB06*Count06)/sum(Count06) ethB06,
   sum(ethB10*Count10)/sum(Count10) ethB10,
   sum(ethB14*Count14)/sum(Count14) ethB14,
   sum(ethB15*Count15)/sum(Count15) ethB15,
   sum(ethB16*Count16)/sum(Count16) ethB16,
   sum(ethL01*Count01)/sum(Count01) ethL01,
   sum(ethL05*Count05)/sum(Count05) ethL05,
   sum(ethL06*Count06)/sum(Count06) ethL06,
   sum(ethL10*Count10)/sum(Count10) ethL10,
   sum(ethL14*Count14)/sum(Count14) ethL14,
   sum(ethL15*Count15)/sum(Count15) ethL15,
   sum(ethL16*Count16)/sum(Count16) ethL16,
   sum(ethM01*Count01)/sum(Count01) ethM01,
   sum(ethM05*Count05)/sum(Count05) ethM05,
   sum(ethM06*Count06)/sum(Count06) ethM06,
   sum(ethM10*Count10)/sum(Count10) ethM10,
   sum(ethM14*Count14)/sum(Count14) ethM14,
   sum(ethM15*Count15)/sum(Count15) ethM15,
   sum(ethM16*Count16)/sum(Count16) ethM16,
   sum(lwIncPc01*Count01)/sum(Count01) lwIncPc01,
   sum(lwIncPc05*Count05)/sum(Count05) lwIncPc05,
   sum(lwIncPc06*Count06)/sum(Count06) lwIncPc06,
   sum(lwIncPc10*Count10)/sum(Count10) lwIncPc10,
   sum(lwIncPc14*Count14)/sum(Count14) lwIncPc14,
   sum(lwIncPc15*Count15)/sum(Count15) lwIncPc15,
   sum(lwIncPc16*Count16)/sum(Count16) lwIncPc16,
   sum(mobRt01*Count01)/sum(Count01) mobRt01,
   sum(mobRt05*Count05)/sum(Count05) mobRt05,
   sum(mobRt06*Count06)/sum(Count06) mobRt06,
   sum(mobRt10*Count10)/sum(Count10) mobRt10,
   sum(mobRt14*Count14)/sum(Count14) mobRt14,
   sum(mobRt15*Count15)/sum(Count15) mobRt15,
   sum(mobRt16*Count16)/sum(Count16) mobRt16,
   sum(LEPPc01*Count01)/sum(Count01) LEPPc01,
   sum(LEPPc05*Count05)/sum(Count05) LEPPc05,
   sum(LEPPc06*Count06)/sum(Count06) LEPPc06,
   sum(LEPPc10*Count10)/sum(Count10) LEPPc10,
   sum(LEPPc14*Count14)/sum(Count14) LEPPc14,
   sum(LEPPc15*Count15)/sum(Count15) LEPPc15,
   sum(LEPPc16*Count16)/sum(Count16) LEPPc16,
   sum(Count01) Count01,
   sum(Count05) Count05,
   sum(Count06) Count06,
   sum(Count10) Count10,
   sum(Count14) Count14,
   sum(Count15) Count15,
   sum(Count16) Count16,
   sum(AtAbove50Pc01*Count01)/sum(Count01) AtAbove50Pc01,
   sum(AtAbove50Pc05*Count05)/sum(Count05) AtAbove50Pc05,
   sum(AtAbove50Pc06*Count06)/sum(Count06) AtAbove50Pc06,
   sum(AtAbove50Pc10*Count10)/sum(Count10) AtAbove50Pc10,
   sum(AtAbove50Pc14*Count14)/sum(Count14) AtAbove50Pc14,
   sum(AtAbove50Pc15*Count15)/sum(Count15) AtAbove50Pc15,
   sum(AtAbove50Pc16*Count16)/sum(Count16) AtAbove50Pc16,
   sum(AtAbove60Pc01*Count01)/sum(Count01) AtAbove60Pc01,
   sum(AtAbove60Pc05*Count05)/sum(Count05) AtAbove60Pc05,
   sum(AtAbove60Pc06*Count06)/sum(Count06) AtAbove60Pc06,
   sum(AtAbove60Pc10*Count10)/sum(Count10) AtAbove60Pc10,
   sum(AtAbove60Pc14*Count14)/sum(Count14) AtAbove60Pc14,
   sum(AtAbove60Pc15*Count15)/sum(Count15) AtAbove60Pc15,
   sum(AtAbove60Pc16*Count16)/sum(Count16) AtAbove60Pc16,
   sum(AtAbove68Pc01*Count01)/sum(Count01) AtAbove68Pc01,
   sum(AtAbove68Pc05*Count05)/sum(Count05) AtAbove68Pc05,
   sum(AtAbove68Pc06*Count06)/sum(Count06) AtAbove68Pc06,
   sum(AtAbove68Pc10*Count10)/sum(Count10) AtAbove68Pc10,
   sum(AtAbove68Pc14*Count14)/sum(Count14) AtAbove68Pc14,
   sum(AtAbove68Pc15*Count15)/sum(Count15) AtAbove68Pc15,
   sum(AtAbove68Pc16*Count16)/sum(Count16) AtAbove68Pc16,
   sum(PercentileAvg01*Count01)/sum(Count01) PercentileAvg01,
   sum(PercentileAvg05*Count05)/sum(Count05) PercentileAvg05,
   sum(PercentileAvg06*Count06)/sum(Count06) PercentileAvg06,
   sum(PercentileAvg10*Count10)/sum(Count10) PercentileAvg10,
   sum(PercentileAvg14*Count14)/sum(Count14) PercentileAvg14,
   sum(PercentileAvg15*Count15)/sum(Count15) PercentileAvg15,
   sum(PercentileAvg16*Count16)/sum(Count16) PercentileAvg16,
   sum(StanineAvg01*Count01)/sum(Count01) StanineAvg01,
   sum(StanineAvg05*Count05)/sum(Count05) StanineAvg05,
   sum(StanineAvg06*Count06)/sum(Count06) StanineAvg06,
   sum(StanineAvg10*Count10)/sum(Count10) StanineAvg10,
   sum(StanineAvg14*Count14)/sum(Count14) StanineAvg14,
   sum(StanineAvg15*Count15)/sum(Count15) StanineAvg15,
   sum(StanineAvg16*Count16)/sum(Count16) StanineAvg16,
   sum(ScoreAvg01*Count01)/sum(Count01) ScoreAvg01,
   sum(ScoreAvg05*Count05)/sum(Count05) ScoreAvg05,
   sum(ScoreAvg06*Count06)/sum(Count06) ScoreAvg06,
   sum(ScoreAvg10*Count10)/sum(Count10) ScoreAvg10,
   sum(ScoreAvg14*Count14)/sum(Count14) ScoreAvg14,
   sum(ScoreAvg15*Count15)/sum(Count15) ScoreAvg15,
   sum(ScoreAvg16*Count16)/sum(Count16) ScoreAvg16,
   sum(s1Avg01*Count01)/sum(Count01) s1Avg01,
   sum(s2Avg01*Count01)/sum(Count01) s2Avg01,
   sum(s3Avg01*Count01)/sum(Count01) s3Avg01,
   sum(s4Avg01*Count01)/sum(Count01) s4Avg01,
   sum(s5Avg01*Count01)/sum(Count01) s5Avg01,
   sum(s6Avg01*Count01)/sum(Count01) s6Avg01,
   sum(s7Avg01*Count01)/sum(Count01) s7Avg01,
   sum(s8Avg01*Count01)/sum(Count01) s8Avg01,
   sum(s9Avg01*Count01)/sum(Count01) s9Avg01,
   sum(s1Avg06*Count06)/sum(Count06) s1Avg06,
   sum(s2Avg06*Count06)/sum(Count06) s2Avg06,
   sum(s3Avg06*Count06)/sum(Count06) s3Avg06,
   sum(s4Avg06*Count06)/sum(Count06) s4Avg06,
   sum(s5Avg06*Count06)/sum(Count06) s5Avg06,
   sum(s6Avg06*Count06)/sum(Count06) s6Avg06,
   sum(s7Avg06*Count06)/sum(Count06) s7Avg06,
   sum(s8Avg06*Count06)/sum(Count06) s8Avg06,
   sum(s9Avg06*Count06)/sum(Count06) s9Avg06,
   sum(s1Avg10*Count10)/sum(Count10) s1Avg10,
   sum(s2Avg10*Count10)/sum(Count10) s2Avg10,
   sum(s3Avg10*Count10)/sum(Count10) s3Avg10,
   sum(s4Avg10*Count10)/sum(Count10) s4Avg10,
   sum(s5Avg10*Count10)/sum(Count10) s5Avg10,
   sum(s6Avg10*Count10)/sum(Count10) s6Avg10,
   sum(s7Avg10*Count10)/sum(Count10) s7Avg10,
   sum(s8Avg10*Count10)/sum(Count10) s8Avg10,
   sum(s9Avg10*Count10)/sum(Count10) s9Avg10,
   sum(s1Avg16*Count16)/sum(Count16) s1Avg16,
   sum(s2Avg16*Count16)/sum(Count16) s2Avg16,
   sum(s3Avg16*Count16)/sum(Count16) s3Avg16,
   sum(s4Avg16*Count16)/sum(Count16) s4Avg16,
   sum(s5Avg16*Count16)/sum(Count16) s5Avg16,
   sum(s6Avg16*Count16)/sum(Count16) s6Avg16,
   sum(s7Avg16*Count16)/sum(Count16) s7Avg16,
   sum(s8Avg16*Count16)/sum(Count16) s8Avg16,
   sum(s9Avg16*Count16)/sum(Count16) s9Avg16,
   'composite' cdts
   from (
   SELECT cdts rc_cdts, max(rcdts) rcdts, max(scName) scName, max(diName) diName, max(county) county, max(schType) schType,
    left(min(rcdts),2) region, mid(max(rcdts),3,3) countyCode,
    if(cdts like 'x016299%',1,
      if(mid(cdts, 2, 3) in ('016', '022', '045', '049', '063', '099'), 2,
        if(mid(cdts, 2, 3) in ( '004', '008', '019', '043', '047', '052', '071', '089', '098', '101'), 3,
          if(mid(cdts, 2, 3) in ( '001', '005', '006', '007', '009', '010', '011', '015', '020', '021', '023', '027', '029', '031', '032', '034', '036', '037', '038', '042', '046', '048', '050', '053', '054', '055', '056', '059', '060', '062', '064', '065', '066', '068', '069', '070', '072', '074', '075', '078', '081', '084', '085', '086', '087', '088', '090', '092', '094', '102'), 4,
            if(mid(cdts, 2, 3) in ('002', '003', '012', '013', '014', '017', '018', '024', '025', '026', '028', '030', '033', '035', '039', '040', '041', '044', '051', '057', '058', '061', '067', '073', '076', '077', '079', '080', '083', '082', '091', '093', '095', '096', '097', '100'), 5,
              0))))) uicRegion,
   max(if(yrending=2001,ethW,null)) ethW01,
   max(if(yrending=2005,ethW,null)) ethW05,
   max(if(yrending=2006,ethW,null)) ethW06,
   max(if(yrending=2010,ethW,null)) ethW10,
   max(if(yrending=2014,ethW,null)) ethW14,
   max(if(yrending=2015,ethW,null)) ethW15,
   max(if(yrending=2016,ethW,null)) ethW16,
   max(if(yrending=2001,ethB,null)) ethB01,
   max(if(yrending=2005,ethB,null)) ethB05,
   max(if(yrending=2006,ethB,null)) ethB06,
   max(if(yrending=2010,ethB,null)) ethB10,
   max(if(yrending=2014,ethB,null)) ethB14,
   max(if(yrending=2015,ethB,null)) ethB15,
   max(if(yrending=2016,ethB,null)) ethB16,
   max(if(yrending=2001,ethL,null)) ethL01,
   max(if(yrending=2005,ethL,null)) ethL05,
   max(if(yrending=2006,ethL,null)) ethL06,
   max(if(yrending=2010,ethL,null)) ethL10,
   max(if(yrending=2014,ethL,null)) ethL14,
   max(if(yrending=2015,ethL,null)) ethL15,
   max(if(yrending=2016,ethL,null)) ethL16,
   max(if(yrending=2001,ethM,null)) ethM01,
   max(if(yrending=2005,ethM,null)) ethM05,
   max(if(yrending=2006,ethM,null)) ethM06,
   max(if(yrending=2010,ethM,null)) ethM10,
   max(if(yrending=2014,ethM,null)) ethM14,
   max(if(yrending=2015,ethM,null)) ethM15,
   max(if(yrending=2016,ethM,null)) ethM16,
   max(if(yrending=2001,lwIncPc,null)) lwIncPc01,
   max(if(yrending=2005,lwIncPc,null)) lwIncPc05,
   max(if(yrending=2006,lwIncPc,null)) lwIncPc06,
   max(if(yrending=2010,lwIncPc,null)) lwIncPc10,
   max(if(yrending=2014,lwIncPc,null)) lwIncPc14,
   max(if(yrending=2015,lwIncPc,null)) lwIncPc15,
   max(if(yrending=2016,lwIncPc,null)) lwIncPc16,
   max(if(yrending=2001,mobRt,null)) mobRt01,
   max(if(yrending=2005,mobRt,null)) mobRt05,
   max(if(yrending=2006,mobRt,null)) mobRt06,
   max(if(yrending=2010,mobRt,null)) mobRt10,
   max(if(yrending=2014,mobRt,null)) mobRt14,
   max(if(yrending=2015,mobRt,null)) mobRt15,
   max(if(yrending=2016,mobRt,null)) mobRt16,
   max(if(yrending=2001,LEPPc,null)) LEPPc01,
   max(if(yrending=2005,LEPPc,null)) LEPPc05,
   max(if(yrending=2006,LEPPc,null)) LEPPc06,
   max(if(yrending=2010,LEPPc,null)) LEPPc10,
   max(if(yrending=2014,LEPPc,null)) LEPPc14,
   max(if(yrending=2015,LEPPc,null)) LEPPc15,
   max(if(yrending=2016,LEPPc,null)) LEPPc16
   FROM isbe_rc
   where yrending in (2001, 2005, 2006, 2010, 2014, 2015, 2016)
   group by rc_cdts
   ) rc

   right join (
   select
   sum(if(year=2001,totalCount,null)) Count01,
   sum(if(year=2005,totalCount,null)) Count05,
   sum(if(year=2006,totalCount,null)) Count06,
   sum(if(year=2010,totalCount,null)) Count10,
   sum(if(year=2014,totalCount,null)) Count14,
   sum(if(year=2015,totalCount,null)) Count15,
   sum(if(year=2016,totalCount,null)) Count16,
   sum(if(year=2001,(q3pct+q4pct)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove50Pc01,
   sum(if(year=2005,(q3pct+q4pct)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove50Pc05,
   sum(if(year=2006,(q3pct+q4pct)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove50Pc06,
   sum(if(year=2010,(q3pct+q4pct)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove50Pc10,
   sum(if(year=2014,(q3pct+q4pct)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove50Pc14,
   sum(if(year=2015,(q3pct+q4pct)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove50Pc15,
   sum(if(year=2016,(q3pct+q4pct)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove50Pc16,
   sum(if(year=2001,(paa60)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove60Pc01,
   sum(if(year=2005,(paa60)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove60Pc05,
   sum(if(year=2006,(paa60)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove60Pc06,
   sum(if(year=2010,(paa60)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove60Pc10,
   sum(if(year=2014,(paa60)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove60Pc14,
   sum(if(year=2015,(paa60)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove60Pc15,
   sum(if(year=2016,(paa60)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove60Pc16,
   sum(if(year=2001,(paa68)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove68Pc01,
   sum(if(year=2005,(paa68)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove68Pc05,
   sum(if(year=2006,(paa68)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove68Pc06,
   sum(if(year=2010,(paa68)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove68Pc10,
   sum(if(year=2014,(paa68)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove68Pc14,
   sum(if(year=2015,(paa68)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove68Pc15,
   sum(if(year=2016,(paa68)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove68Pc16,
   sum(if(year=2001,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2001,totalCount,null)) PercentileAvg01,
   sum(if(year=2005,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2005,totalCount,null)) PercentileAvg05,
   sum(if(year=2006,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2006,totalCount,null)) PercentileAvg06,
   sum(if(year=2010,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2010,totalCount,null)) PercentileAvg10,
   sum(if(year=2014,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2014,totalCount,null)) PercentileAvg14,
   sum(if(year=2015,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2015,totalCount,null)) PercentileAvg15,
   sum(if(year=2016,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2016,totalCount,null)) PercentileAvg16,
   sum(if(year=2001,(stanine)*totalCount,null))/sum(if(year=2001,totalCount,null)) StanineAvg01,
   sum(if(year=2005,(stanine)*totalCount,null))/sum(if(year=2005,totalCount,null)) StanineAvg05,
   sum(if(year=2006,(stanine)*totalCount,null))/sum(if(year=2006,totalCount,null)) StanineAvg06,
   sum(if(year=2010,(stanine)*totalCount,null))/sum(if(year=2010,totalCount,null)) StanineAvg10,
   sum(if(year=2014,(stanine)*totalCount,null))/sum(if(year=2014,totalCount,null)) StanineAvg14,
   sum(if(year=2015,(stanine)*totalCount,null))/sum(if(year=2015,totalCount,null)) StanineAvg15,
   sum(if(year=2016,(stanine)*totalCount,null))/sum(if(year=2016,totalCount,null)) StanineAvg16,
   sum(if(year=2001,(wAvgScore)*totalCount,null))/sum(if(year=2001,totalCount,null)) ScoreAvg01,
   sum(if(year=2005,(wAvgScore)*totalCount,null))/sum(if(year=2005,totalCount,null)) ScoreAvg05,
   sum(if(year=2006,(wAvgScore)*totalCount,null))/sum(if(year=2006,totalCount,null)) ScoreAvg06,
   sum(if(year=2010,(wAvgScore)*totalCount,null))/sum(if(year=2010,totalCount,null)) ScoreAvg10,
   sum(if(year=2014,(wAvgScore)*totalCount,null))/sum(if(year=2014,totalCount,null)) ScoreAvg14,
   sum(if(year=2015,(wAvgScore)*totalCount,null))/sum(if(year=2015,totalCount,null)) ScoreAvg15,
   sum(if(year=2016,(wAvgScore)*totalCount,null))/sum(if(year=2016,totalCount,null)) ScoreAvg16,
   sum(if(year=2001,s1pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s1Avg01,
   sum(if(year=2001,s2pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s2Avg01,
   sum(if(year=2001,s3pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s3Avg01,
   sum(if(year=2001,s4pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s4Avg01,
   sum(if(year=2001,s5pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s5Avg01,
   sum(if(year=2001,s6pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s6Avg01,
   sum(if(year=2001,s7pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s7Avg01,
   sum(if(year=2001,s8pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s8Avg01,
   sum(if(year=2001,s9pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s9Avg01,
   sum(if(year=2006,s1pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s1Avg06,
   sum(if(year=2006,s2pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s2Avg06,
   sum(if(year=2006,s3pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s3Avg06,
   sum(if(year=2006,s4pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s4Avg06,
   sum(if(year=2006,s5pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s5Avg06,
   sum(if(year=2006,s6pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s6Avg06,
   sum(if(year=2006,s7pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s7Avg06,
   sum(if(year=2006,s8pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s8Avg06,
   sum(if(year=2006,s9pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s9Avg06,
   sum(if(year=2010,s1pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s1Avg10,
   sum(if(year=2010,s2pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s2Avg10,
   sum(if(year=2010,s3pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s3Avg10,
   sum(if(year=2010,s4pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s4Avg10,
   sum(if(year=2010,s5pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s5Avg10,
   sum(if(year=2010,s6pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s6Avg10,
   sum(if(year=2010,s7pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s7Avg10,
   sum(if(year=2010,s8pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s8Avg10,
   sum(if(year=2010,s9pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s9Avg10,
   sum(if(year=2016,s1pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s1Avg16,
   sum(if(year=2016,s2pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s2Avg16,
   sum(if(year=2016,s3pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s3Avg16,
   sum(if(year=2016,s4pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s4Avg16,
   sum(if(year=2016,s5pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s5Avg16,
   sum(if(year=2016,s6pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s6Avg16,
   sum(if(year=2016,s7pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s7Avg16,
   sum(if(year=2016,s8pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s8Avg16,
   sum(if(year=2016,s9pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s9Avg16,
   cdts
   from schwideComposites
   where year in (2001, 2005, 2006, 2010, 2014, 2015, 2016)
    and subj = 'Reading'
   group by cdts
   ) swc on (swc.cdts=rc.rc_cdts)

   union

   select 'Reading' subj,
   'composite' rc_cdts, 'composite' rcdts, 'State-wide composite outside of CPS' scName, '' diName, '' county, '' schType, '' region, '' countyCode, '' uicRegion,
   sum(ethW01*Count01)/sum(Count01) ethW01,
   sum(ethW05*Count05)/sum(Count05) ethW05,
   sum(ethW06*Count06)/sum(Count06) ethW06,
   sum(ethW10*Count10)/sum(Count10) ethW10,
   sum(ethW14*Count14)/sum(Count14) ethW14,
   sum(ethW15*Count15)/sum(Count15) ethW15,
   sum(ethW16*Count16)/sum(Count16) ethW16,
   sum(ethB01*Count01)/sum(Count01) ethB01,
   sum(ethB05*Count05)/sum(Count05) ethB05,
   sum(ethB06*Count06)/sum(Count06) ethB06,
   sum(ethB10*Count10)/sum(Count10) ethB10,
   sum(ethB14*Count14)/sum(Count14) ethB14,
   sum(ethB15*Count15)/sum(Count15) ethB15,
   sum(ethB16*Count16)/sum(Count16) ethB16,
   sum(ethL01*Count01)/sum(Count01) ethL01,
   sum(ethL05*Count05)/sum(Count05) ethL05,
   sum(ethL06*Count06)/sum(Count06) ethL06,
   sum(ethL10*Count10)/sum(Count10) ethL10,
   sum(ethL14*Count14)/sum(Count14) ethL14,
   sum(ethL15*Count15)/sum(Count15) ethL15,
   sum(ethL16*Count16)/sum(Count16) ethL16,
   sum(ethM01*Count01)/sum(Count01) ethM01,
   sum(ethM05*Count05)/sum(Count05) ethM05,
   sum(ethM06*Count06)/sum(Count06) ethM06,
   sum(ethM10*Count10)/sum(Count10) ethM10,
   sum(ethM14*Count14)/sum(Count14) ethM14,
   sum(ethM15*Count15)/sum(Count15) ethM15,
   sum(ethM16*Count16)/sum(Count16) ethM16,
   sum(lwIncPc01*Count01)/sum(Count01) lwIncPc01,
   sum(lwIncPc05*Count05)/sum(Count05) lwIncPc05,
   sum(lwIncPc06*Count06)/sum(Count06) lwIncPc06,
   sum(lwIncPc10*Count10)/sum(Count10) lwIncPc10,
   sum(lwIncPc14*Count14)/sum(Count14) lwIncPc14,
   sum(lwIncPc15*Count15)/sum(Count15) lwIncPc15,
   sum(lwIncPc16*Count16)/sum(Count16) lwIncPc16,
   sum(mobRt01*Count01)/sum(Count01) mobRt01,
   sum(mobRt05*Count05)/sum(Count05) mobRt05,
   sum(mobRt06*Count06)/sum(Count06) mobRt06,
   sum(mobRt10*Count10)/sum(Count10) mobRt10,
   sum(mobRt14*Count14)/sum(Count14) mobRt14,
   sum(mobRt15*Count15)/sum(Count15) mobRt15,
   sum(mobRt16*Count16)/sum(Count16) mobRt16,
   sum(LEPPc01*Count01)/sum(Count01) LEPPc01,
   sum(LEPPc05*Count05)/sum(Count05) LEPPc05,
   sum(LEPPc06*Count06)/sum(Count06) LEPPc06,
   sum(LEPPc10*Count10)/sum(Count10) LEPPc10,
   sum(LEPPc14*Count14)/sum(Count14) LEPPc14,
   sum(LEPPc15*Count15)/sum(Count15) LEPPc15,
   sum(LEPPc16*Count16)/sum(Count16) LEPPc16,
   sum(Count01) Count01,
   sum(Count05) Count05,
   sum(Count06) Count06,
   sum(Count10) Count10,
   sum(Count14) Count14,
   sum(Count15) Count15,
   sum(Count16) Count16,
   sum(AtAbove50Pc01*Count01)/sum(Count01) AtAbove50Pc01,
   sum(AtAbove50Pc05*Count05)/sum(Count05) AtAbove50Pc05,
   sum(AtAbove50Pc06*Count06)/sum(Count06) AtAbove50Pc06,
   sum(AtAbove50Pc10*Count10)/sum(Count10) AtAbove50Pc10,
   sum(AtAbove50Pc14*Count14)/sum(Count14) AtAbove50Pc14,
   sum(AtAbove50Pc15*Count15)/sum(Count15) AtAbove50Pc15,
   sum(AtAbove50Pc16*Count16)/sum(Count16) AtAbove50Pc16,
   sum(AtAbove60Pc01*Count01)/sum(Count01) AtAbove60Pc01,
   sum(AtAbove60Pc05*Count05)/sum(Count05) AtAbove60Pc05,
   sum(AtAbove60Pc06*Count06)/sum(Count06) AtAbove60Pc06,
   sum(AtAbove60Pc10*Count10)/sum(Count10) AtAbove60Pc10,
   sum(AtAbove60Pc14*Count14)/sum(Count14) AtAbove60Pc14,
   sum(AtAbove60Pc15*Count15)/sum(Count15) AtAbove60Pc15,
   sum(AtAbove60Pc16*Count16)/sum(Count16) AtAbove60Pc16,
   sum(AtAbove68Pc01*Count01)/sum(Count01) AtAbove68Pc01,
   sum(AtAbove68Pc05*Count05)/sum(Count05) AtAbove68Pc05,
   sum(AtAbove68Pc06*Count06)/sum(Count06) AtAbove68Pc06,
   sum(AtAbove68Pc10*Count10)/sum(Count10) AtAbove68Pc10,
   sum(AtAbove68Pc14*Count14)/sum(Count14) AtAbove68Pc14,
   sum(AtAbove68Pc15*Count15)/sum(Count15) AtAbove68Pc15,
   sum(AtAbove68Pc16*Count16)/sum(Count16) AtAbove68Pc16,
   sum(PercentileAvg01*Count01)/sum(Count01) PercentileAvg01,
   sum(PercentileAvg05*Count05)/sum(Count05) PercentileAvg05,
   sum(PercentileAvg06*Count06)/sum(Count06) PercentileAvg06,
   sum(PercentileAvg10*Count10)/sum(Count10) PercentileAvg10,
   sum(PercentileAvg14*Count14)/sum(Count14) PercentileAvg14,
   sum(PercentileAvg15*Count15)/sum(Count15) PercentileAvg15,
   sum(PercentileAvg16*Count16)/sum(Count16) PercentileAvg16,
   sum(StanineAvg01*Count01)/sum(Count01) StanineAvg01,
   sum(StanineAvg05*Count05)/sum(Count05) StanineAvg05,
   sum(StanineAvg06*Count06)/sum(Count06) StanineAvg06,
   sum(StanineAvg10*Count10)/sum(Count10) StanineAvg10,
   sum(StanineAvg14*Count14)/sum(Count14) StanineAvg14,
   sum(StanineAvg15*Count15)/sum(Count15) StanineAvg15,
   sum(StanineAvg16*Count16)/sum(Count16) StanineAvg16,
   sum(ScoreAvg01*Count01)/sum(Count01) ScoreAvg01,
   sum(ScoreAvg05*Count05)/sum(Count05) ScoreAvg05,
   sum(ScoreAvg06*Count06)/sum(Count06) ScoreAvg06,
   sum(ScoreAvg10*Count10)/sum(Count10) ScoreAvg10,
   sum(ScoreAvg14*Count14)/sum(Count14) ScoreAvg14,
   sum(ScoreAvg15*Count15)/sum(Count15) ScoreAvg15,
   sum(ScoreAvg16*Count16)/sum(Count16) ScoreAvg16,
   sum(s1Avg01*Count01)/sum(Count01) s1Avg01,
   sum(s2Avg01*Count01)/sum(Count01) s2Avg01,
   sum(s3Avg01*Count01)/sum(Count01) s3Avg01,
   sum(s4Avg01*Count01)/sum(Count01) s4Avg01,
   sum(s5Avg01*Count01)/sum(Count01) s5Avg01,
   sum(s6Avg01*Count01)/sum(Count01) s6Avg01,
   sum(s7Avg01*Count01)/sum(Count01) s7Avg01,
   sum(s8Avg01*Count01)/sum(Count01) s8Avg01,
   sum(s9Avg01*Count01)/sum(Count01) s9Avg01,
   sum(s1Avg06*Count06)/sum(Count06) s1Avg06,
   sum(s2Avg06*Count06)/sum(Count06) s2Avg06,
   sum(s3Avg06*Count06)/sum(Count06) s3Avg06,
   sum(s4Avg06*Count06)/sum(Count06) s4Avg06,
   sum(s5Avg06*Count06)/sum(Count06) s5Avg06,
   sum(s6Avg06*Count06)/sum(Count06) s6Avg06,
   sum(s7Avg06*Count06)/sum(Count06) s7Avg06,
   sum(s8Avg06*Count06)/sum(Count06) s8Avg06,
   sum(s9Avg06*Count06)/sum(Count06) s9Avg06,
   sum(s1Avg10*Count10)/sum(Count10) s1Avg10,
   sum(s2Avg10*Count10)/sum(Count10) s2Avg10,
   sum(s3Avg10*Count10)/sum(Count10) s3Avg10,
   sum(s4Avg10*Count10)/sum(Count10) s4Avg10,
   sum(s5Avg10*Count10)/sum(Count10) s5Avg10,
   sum(s6Avg10*Count10)/sum(Count10) s6Avg10,
   sum(s7Avg10*Count10)/sum(Count10) s7Avg10,
   sum(s8Avg10*Count10)/sum(Count10) s8Avg10,
   sum(s9Avg10*Count10)/sum(Count10) s9Avg10,
   sum(s1Avg16*Count16)/sum(Count16) s1Avg16,
   sum(s2Avg16*Count16)/sum(Count16) s2Avg16,
   sum(s3Avg16*Count16)/sum(Count16) s3Avg16,
   sum(s4Avg16*Count16)/sum(Count16) s4Avg16,
   sum(s5Avg16*Count16)/sum(Count16) s5Avg16,
   sum(s6Avg16*Count16)/sum(Count16) s6Avg16,
   sum(s7Avg16*Count16)/sum(Count16) s7Avg16,
   sum(s8Avg16*Count16)/sum(Count16) s8Avg16,
   sum(s9Avg16*Count16)/sum(Count16) s9Avg16,
   'composite' cdts
   from (
   SELECT cdts rc_cdts, max(rcdts) rcdts, max(scName) scName, max(diName) diName, max(county) county, max(schType) schType,
    left(min(rcdts),2) region, mid(max(rcdts),3,3) countyCode,
    if(cdts like 'x016299%',1,
      if(mid(cdts, 2, 3) in ('016', '022', '045', '049', '063', '099'), 2,
        if(mid(cdts, 2, 3) in ( '004', '008', '019', '043', '047', '052', '071', '089', '098', '101'), 3,
          if(mid(cdts, 2, 3) in ( '001', '005', '006', '007', '009', '010', '011', '015', '020', '021', '023', '027', '029', '031', '032', '034', '036', '037', '038', '042', '046', '048', '050', '053', '054', '055', '056', '059', '060', '062', '064', '065', '066', '068', '069', '070', '072', '074', '075', '078', '081', '084', '085', '086', '087', '088', '090', '092', '094', '102'), 4,
            if(mid(cdts, 2, 3) in ('002', '003', '012', '013', '014', '017', '018', '024', '025', '026', '028', '030', '033', '035', '039', '040', '041', '044', '051', '057', '058', '061', '067', '073', '076', '077', '079', '080', '083', '082', '091', '093', '095', '096', '097', '100'), 5,
              0))))) uicRegion,
   max(if(yrending=2001,ethW,null)) ethW01,
   max(if(yrending=2005,ethW,null)) ethW05,
   max(if(yrending=2006,ethW,null)) ethW06,
   max(if(yrending=2010,ethW,null)) ethW10,
   max(if(yrending=2014,ethW,null)) ethW14,
   max(if(yrending=2015,ethW,null)) ethW15,
   max(if(yrending=2016,ethW,null)) ethW16,
   max(if(yrending=2001,ethB,null)) ethB01,
   max(if(yrending=2005,ethB,null)) ethB05,
   max(if(yrending=2006,ethB,null)) ethB06,
   max(if(yrending=2010,ethB,null)) ethB10,
   max(if(yrending=2014,ethB,null)) ethB14,
   max(if(yrending=2015,ethB,null)) ethB15,
   max(if(yrending=2016,ethB,null)) ethB16,
   max(if(yrending=2001,ethL,null)) ethL01,
   max(if(yrending=2005,ethL,null)) ethL05,
   max(if(yrending=2006,ethL,null)) ethL06,
   max(if(yrending=2010,ethL,null)) ethL10,
   max(if(yrending=2014,ethL,null)) ethL14,
   max(if(yrending=2015,ethL,null)) ethL15,
   max(if(yrending=2016,ethL,null)) ethL16,
   max(if(yrending=2001,ethM,null)) ethM01,
   max(if(yrending=2005,ethM,null)) ethM05,
   max(if(yrending=2006,ethM,null)) ethM06,
   max(if(yrending=2010,ethM,null)) ethM10,
   max(if(yrending=2014,ethM,null)) ethM14,
   max(if(yrending=2015,ethM,null)) ethM15,
   max(if(yrending=2016,ethM,null)) ethM16,
   max(if(yrending=2001,lwIncPc,null)) lwIncPc01,
   max(if(yrending=2005,lwIncPc,null)) lwIncPc05,
   max(if(yrending=2006,lwIncPc,null)) lwIncPc06,
   max(if(yrending=2010,lwIncPc,null)) lwIncPc10,
   max(if(yrending=2014,lwIncPc,null)) lwIncPc14,
   max(if(yrending=2015,lwIncPc,null)) lwIncPc15,
   max(if(yrending=2016,lwIncPc,null)) lwIncPc16,
   max(if(yrending=2001,mobRt,null)) mobRt01,
   max(if(yrending=2005,mobRt,null)) mobRt05,
   max(if(yrending=2006,mobRt,null)) mobRt06,
   max(if(yrending=2010,mobRt,null)) mobRt10,
   max(if(yrending=2014,mobRt,null)) mobRt14,
   max(if(yrending=2015,mobRt,null)) mobRt15,
   max(if(yrending=2016,mobRt,null)) mobRt16,
   max(if(yrending=2001,LEPPc,null)) LEPPc01,
   max(if(yrending=2005,LEPPc,null)) LEPPc05,
   max(if(yrending=2006,LEPPc,null)) LEPPc06,
   max(if(yrending=2010,LEPPc,null)) LEPPc10,
   max(if(yrending=2014,LEPPc,null)) LEPPc14,
   max(if(yrending=2015,LEPPc,null)) LEPPc15,
   max(if(yrending=2016,LEPPc,null)) LEPPc16
   FROM isbe_rc
   where yrending in (2001, 2005, 2006, 2010, 2014, 2015, 2016)
   group by rc_cdts
   ) rc

   right join (
   select
   sum(if(year=2001,totalCount,null)) Count01,
   sum(if(year=2005,totalCount,null)) Count05,
   sum(if(year=2006,totalCount,null)) Count06,
   sum(if(year=2010,totalCount,null)) Count10,
   sum(if(year=2014,totalCount,null)) Count14,
   sum(if(year=2015,totalCount,null)) Count15,
   sum(if(year=2016,totalCount,null)) Count16,
   sum(if(year=2001,(q3pct+q4pct)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove50Pc01,
   sum(if(year=2005,(q3pct+q4pct)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove50Pc05,
   sum(if(year=2006,(q3pct+q4pct)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove50Pc06,
   sum(if(year=2010,(q3pct+q4pct)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove50Pc10,
   sum(if(year=2014,(q3pct+q4pct)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove50Pc14,
   sum(if(year=2015,(q3pct+q4pct)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove50Pc15,
   sum(if(year=2016,(q3pct+q4pct)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove50Pc16,
   sum(if(year=2001,(paa60)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove60Pc01,
   sum(if(year=2005,(paa60)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove60Pc05,
   sum(if(year=2006,(paa60)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove60Pc06,
   sum(if(year=2010,(paa60)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove60Pc10,
   sum(if(year=2014,(paa60)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove60Pc14,
   sum(if(year=2015,(paa60)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove60Pc15,
   sum(if(year=2016,(paa60)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove60Pc16,
   sum(if(year=2001,(paa68)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove68Pc01,
   sum(if(year=2005,(paa68)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove68Pc05,
   sum(if(year=2006,(paa68)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove68Pc06,
   sum(if(year=2010,(paa68)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove68Pc10,
   sum(if(year=2014,(paa68)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove68Pc14,
   sum(if(year=2015,(paa68)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove68Pc15,
   sum(if(year=2016,(paa68)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove68Pc16,
   sum(if(year=2001,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2001,totalCount,null)) PercentileAvg01,
   sum(if(year=2005,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2005,totalCount,null)) PercentileAvg05,
   sum(if(year=2006,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2006,totalCount,null)) PercentileAvg06,
   sum(if(year=2010,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2010,totalCount,null)) PercentileAvg10,
   sum(if(year=2014,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2014,totalCount,null)) PercentileAvg14,
   sum(if(year=2015,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2015,totalCount,null)) PercentileAvg15,
   sum(if(year=2016,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2016,totalCount,null)) PercentileAvg16,
   sum(if(year=2001,(stanine)*totalCount,null))/sum(if(year=2001,totalCount,null)) StanineAvg01,
   sum(if(year=2005,(stanine)*totalCount,null))/sum(if(year=2005,totalCount,null)) StanineAvg05,
   sum(if(year=2006,(stanine)*totalCount,null))/sum(if(year=2006,totalCount,null)) StanineAvg06,
   sum(if(year=2010,(stanine)*totalCount,null))/sum(if(year=2010,totalCount,null)) StanineAvg10,
   sum(if(year=2014,(stanine)*totalCount,null))/sum(if(year=2014,totalCount,null)) StanineAvg14,
   sum(if(year=2015,(stanine)*totalCount,null))/sum(if(year=2015,totalCount,null)) StanineAvg15,
   sum(if(year=2016,(stanine)*totalCount,null))/sum(if(year=2016,totalCount,null)) StanineAvg16,
   sum(if(year=2001,(wAvgScore)*totalCount,null))/sum(if(year=2001,totalCount,null)) ScoreAvg01,
   sum(if(year=2005,(wAvgScore)*totalCount,null))/sum(if(year=2005,totalCount,null)) ScoreAvg05,
   sum(if(year=2006,(wAvgScore)*totalCount,null))/sum(if(year=2006,totalCount,null)) ScoreAvg06,
   sum(if(year=2010,(wAvgScore)*totalCount,null))/sum(if(year=2010,totalCount,null)) ScoreAvg10,
   sum(if(year=2014,(wAvgScore)*totalCount,null))/sum(if(year=2014,totalCount,null)) ScoreAvg14,
   sum(if(year=2015,(wAvgScore)*totalCount,null))/sum(if(year=2015,totalCount,null)) ScoreAvg15,
   sum(if(year=2016,(wAvgScore)*totalCount,null))/sum(if(year=2016,totalCount,null)) ScoreAvg16,
   sum(if(year=2001,s1pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s1Avg01,
   sum(if(year=2001,s2pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s2Avg01,
   sum(if(year=2001,s3pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s3Avg01,
   sum(if(year=2001,s4pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s4Avg01,
   sum(if(year=2001,s5pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s5Avg01,
   sum(if(year=2001,s6pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s6Avg01,
   sum(if(year=2001,s7pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s7Avg01,
   sum(if(year=2001,s8pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s8Avg01,
   sum(if(year=2001,s9pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s9Avg01,
   sum(if(year=2006,s1pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s1Avg06,
   sum(if(year=2006,s2pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s2Avg06,
   sum(if(year=2006,s3pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s3Avg06,
   sum(if(year=2006,s4pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s4Avg06,
   sum(if(year=2006,s5pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s5Avg06,
   sum(if(year=2006,s6pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s6Avg06,
   sum(if(year=2006,s7pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s7Avg06,
   sum(if(year=2006,s8pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s8Avg06,
   sum(if(year=2006,s9pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s9Avg06,
   sum(if(year=2010,s1pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s1Avg10,
   sum(if(year=2010,s2pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s2Avg10,
   sum(if(year=2010,s3pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s3Avg10,
   sum(if(year=2010,s4pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s4Avg10,
   sum(if(year=2010,s5pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s5Avg10,
   sum(if(year=2010,s6pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s6Avg10,
   sum(if(year=2010,s7pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s7Avg10,
   sum(if(year=2010,s8pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s8Avg10,
   sum(if(year=2010,s9pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s9Avg10,
   sum(if(year=2016,s1pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s1Avg16,
   sum(if(year=2016,s2pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s2Avg16,
   sum(if(year=2016,s3pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s3Avg16,
   sum(if(year=2016,s4pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s4Avg16,
   sum(if(year=2016,s5pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s5Avg16,
   sum(if(year=2016,s6pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s6Avg16,
   sum(if(year=2016,s7pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s7Avg16,
   sum(if(year=2016,s8pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s8Avg16,
   sum(if(year=2016,s9pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s9Avg16,
   cdts
   from schwideComposites
   where year in (2001, 2005, 2006, 2010, 2014, 2015, 2016)
    and subj = 'Reading'
   group by cdts
   ) swc on (swc.cdts=rc.rc_cdts)
   where cdts not like 'x016299%'

   union

   select 'Reading' subj,
   'composite' rc_cdts, 'composite' rcdts, concat('UIC Region ', uicRegion) scName, '' diName, '' county, '' schType, '' region, '' countyCode, uicRegion,
   sum(ethW01*Count01)/sum(Count01) ethW01,
   sum(ethW05*Count05)/sum(Count05) ethW05,
   sum(ethW06*Count06)/sum(Count06) ethW06,
   sum(ethW10*Count10)/sum(Count10) ethW10,
   sum(ethW14*Count14)/sum(Count14) ethW14,
   sum(ethW15*Count15)/sum(Count15) ethW15,
   sum(ethW16*Count16)/sum(Count16) ethW16,
   sum(ethB01*Count01)/sum(Count01) ethB01,
   sum(ethB05*Count05)/sum(Count05) ethB05,
   sum(ethB06*Count06)/sum(Count06) ethB06,
   sum(ethB10*Count10)/sum(Count10) ethB10,
   sum(ethB14*Count14)/sum(Count14) ethB14,
   sum(ethB15*Count15)/sum(Count15) ethB15,
   sum(ethB16*Count16)/sum(Count16) ethB16,
   sum(ethL01*Count01)/sum(Count01) ethL01,
   sum(ethL05*Count05)/sum(Count05) ethL05,
   sum(ethL06*Count06)/sum(Count06) ethL06,
   sum(ethL10*Count10)/sum(Count10) ethL10,
   sum(ethL14*Count14)/sum(Count14) ethL14,
   sum(ethL15*Count15)/sum(Count15) ethL15,
   sum(ethL16*Count16)/sum(Count16) ethL16,
   sum(ethM01*Count01)/sum(Count01) ethM01,
   sum(ethM05*Count05)/sum(Count05) ethM05,
   sum(ethM06*Count06)/sum(Count06) ethM06,
   sum(ethM10*Count10)/sum(Count10) ethM10,
   sum(ethM14*Count14)/sum(Count14) ethM14,
   sum(ethM15*Count15)/sum(Count15) ethM15,
   sum(ethM16*Count16)/sum(Count16) ethM16,
   sum(lwIncPc01*Count01)/sum(Count01) lwIncPc01,
   sum(lwIncPc05*Count05)/sum(Count05) lwIncPc05,
   sum(lwIncPc06*Count06)/sum(Count06) lwIncPc06,
   sum(lwIncPc10*Count10)/sum(Count10) lwIncPc10,
   sum(lwIncPc14*Count14)/sum(Count14) lwIncPc14,
   sum(lwIncPc15*Count15)/sum(Count15) lwIncPc15,
   sum(lwIncPc16*Count16)/sum(Count16) lwIncPc16,
   sum(mobRt01*Count01)/sum(Count01) mobRt01,
   sum(mobRt05*Count05)/sum(Count05) mobRt05,
   sum(mobRt06*Count06)/sum(Count06) mobRt06,
   sum(mobRt10*Count10)/sum(Count10) mobRt10,
   sum(mobRt14*Count14)/sum(Count14) mobRt14,
   sum(mobRt15*Count15)/sum(Count15) mobRt15,
   sum(mobRt16*Count16)/sum(Count16) mobRt16,
   sum(LEPPc01*Count01)/sum(Count01) LEPPc01,
   sum(LEPPc05*Count05)/sum(Count05) LEPPc05,
   sum(LEPPc06*Count06)/sum(Count06) LEPPc06,
   sum(LEPPc10*Count10)/sum(Count10) LEPPc10,
   sum(LEPPc14*Count14)/sum(Count14) LEPPc14,
   sum(LEPPc15*Count15)/sum(Count15) LEPPc15,
   sum(LEPPc16*Count16)/sum(Count16) LEPPc16,
   sum(Count01) Count01,
   sum(Count05) Count05,
   sum(Count06) Count06,
   sum(Count10) Count10,
   sum(Count14) Count14,
   sum(Count15) Count15,
   sum(Count16) Count16,
   sum(AtAbove50Pc01*Count01)/sum(Count01) AtAbove50Pc01,
   sum(AtAbove50Pc05*Count05)/sum(Count05) AtAbove50Pc05,
   sum(AtAbove50Pc06*Count06)/sum(Count06) AtAbove50Pc06,
   sum(AtAbove50Pc10*Count10)/sum(Count10) AtAbove50Pc10,
   sum(AtAbove50Pc14*Count14)/sum(Count14) AtAbove50Pc14,
   sum(AtAbove50Pc15*Count15)/sum(Count15) AtAbove50Pc15,
   sum(AtAbove50Pc16*Count16)/sum(Count16) AtAbove50Pc16,
   sum(AtAbove60Pc01*Count01)/sum(Count01) AtAbove60Pc01,
   sum(AtAbove60Pc05*Count05)/sum(Count05) AtAbove60Pc05,
   sum(AtAbove60Pc06*Count06)/sum(Count06) AtAbove60Pc06,
   sum(AtAbove60Pc10*Count10)/sum(Count10) AtAbove60Pc10,
   sum(AtAbove60Pc14*Count14)/sum(Count14) AtAbove60Pc14,
   sum(AtAbove60Pc15*Count15)/sum(Count15) AtAbove60Pc15,
   sum(AtAbove60Pc16*Count16)/sum(Count16) AtAbove60Pc16,
   sum(AtAbove68Pc01*Count01)/sum(Count01) AtAbove68Pc01,
   sum(AtAbove68Pc05*Count05)/sum(Count05) AtAbove68Pc05,
   sum(AtAbove68Pc06*Count06)/sum(Count06) AtAbove68Pc06,
   sum(AtAbove68Pc10*Count10)/sum(Count10) AtAbove68Pc10,
   sum(AtAbove68Pc14*Count14)/sum(Count14) AtAbove68Pc14,
   sum(AtAbove68Pc15*Count15)/sum(Count15) AtAbove68Pc15,
   sum(AtAbove68Pc16*Count16)/sum(Count16) AtAbove68Pc16,
   sum(PercentileAvg01*Count01)/sum(Count01) PercentileAvg01,
   sum(PercentileAvg05*Count05)/sum(Count05) PercentileAvg05,
   sum(PercentileAvg06*Count06)/sum(Count06) PercentileAvg06,
   sum(PercentileAvg10*Count10)/sum(Count10) PercentileAvg10,
   sum(PercentileAvg14*Count14)/sum(Count14) PercentileAvg14,
   sum(PercentileAvg15*Count15)/sum(Count15) PercentileAvg15,
   sum(PercentileAvg16*Count16)/sum(Count16) PercentileAvg16,
   sum(StanineAvg01*Count01)/sum(Count01) StanineAvg01,
   sum(StanineAvg05*Count05)/sum(Count05) StanineAvg05,
   sum(StanineAvg06*Count06)/sum(Count06) StanineAvg06,
   sum(StanineAvg10*Count10)/sum(Count10) StanineAvg10,
   sum(StanineAvg14*Count14)/sum(Count14) StanineAvg14,
   sum(StanineAvg15*Count15)/sum(Count15) StanineAvg15,
   sum(StanineAvg16*Count16)/sum(Count16) StanineAvg16,
   sum(ScoreAvg01*Count01)/sum(Count01) ScoreAvg01,
   sum(ScoreAvg05*Count05)/sum(Count05) ScoreAvg05,
   sum(ScoreAvg06*Count06)/sum(Count06) ScoreAvg06,
   sum(ScoreAvg10*Count10)/sum(Count10) ScoreAvg10,
   sum(ScoreAvg14*Count14)/sum(Count14) ScoreAvg14,
   sum(ScoreAvg15*Count15)/sum(Count15) ScoreAvg15,
   sum(ScoreAvg16*Count16)/sum(Count16) ScoreAvg16,
   sum(s1Avg01*Count01)/sum(Count01) s1Avg01,
   sum(s2Avg01*Count01)/sum(Count01) s2Avg01,
   sum(s3Avg01*Count01)/sum(Count01) s3Avg01,
   sum(s4Avg01*Count01)/sum(Count01) s4Avg01,
   sum(s5Avg01*Count01)/sum(Count01) s5Avg01,
   sum(s6Avg01*Count01)/sum(Count01) s6Avg01,
   sum(s7Avg01*Count01)/sum(Count01) s7Avg01,
   sum(s8Avg01*Count01)/sum(Count01) s8Avg01,
   sum(s9Avg01*Count01)/sum(Count01) s9Avg01,
   sum(s1Avg06*Count06)/sum(Count06) s1Avg06,
   sum(s2Avg06*Count06)/sum(Count06) s2Avg06,
   sum(s3Avg06*Count06)/sum(Count06) s3Avg06,
   sum(s4Avg06*Count06)/sum(Count06) s4Avg06,
   sum(s5Avg06*Count06)/sum(Count06) s5Avg06,
   sum(s6Avg06*Count06)/sum(Count06) s6Avg06,
   sum(s7Avg06*Count06)/sum(Count06) s7Avg06,
   sum(s8Avg06*Count06)/sum(Count06) s8Avg06,
   sum(s9Avg06*Count06)/sum(Count06) s9Avg06,
   sum(s1Avg10*Count10)/sum(Count10) s1Avg10,
   sum(s2Avg10*Count10)/sum(Count10) s2Avg10,
   sum(s3Avg10*Count10)/sum(Count10) s3Avg10,
   sum(s4Avg10*Count10)/sum(Count10) s4Avg10,
   sum(s5Avg10*Count10)/sum(Count10) s5Avg10,
   sum(s6Avg10*Count10)/sum(Count10) s6Avg10,
   sum(s7Avg10*Count10)/sum(Count10) s7Avg10,
   sum(s8Avg10*Count10)/sum(Count10) s8Avg10,
   sum(s9Avg10*Count10)/sum(Count10) s9Avg10,
   sum(s1Avg16*Count16)/sum(Count16) s1Avg16,
   sum(s2Avg16*Count16)/sum(Count16) s2Avg16,
   sum(s3Avg16*Count16)/sum(Count16) s3Avg16,
   sum(s4Avg16*Count16)/sum(Count16) s4Avg16,
   sum(s5Avg16*Count16)/sum(Count16) s5Avg16,
   sum(s6Avg16*Count16)/sum(Count16) s6Avg16,
   sum(s7Avg16*Count16)/sum(Count16) s7Avg16,
   sum(s8Avg16*Count16)/sum(Count16) s8Avg16,
   sum(s9Avg16*Count16)/sum(Count16) s9Avg16,
   'composite' cdts
   from (
   SELECT cdts rc_cdts, max(rcdts) rcdts, max(scName) scName, max(diName) diName, max(county) county, max(schType) schType,
    left(min(rcdts),2) region, mid(max(rcdts),3,3) countyCode,
    if(cdts like 'x016299%',1,
      if(mid(cdts, 2, 3) in ('016', '022', '045', '049', '063', '099'), 2,
        if(mid(cdts, 2, 3) in ( '004', '008', '019', '043', '047', '052', '071', '089', '098', '101'), 3,
          if(mid(cdts, 2, 3) in ( '001', '005', '006', '007', '009', '010', '011', '015', '020', '021', '023', '027', '029', '031', '032', '034', '036', '037', '038', '042', '046', '048', '050', '053', '054', '055', '056', '059', '060', '062', '064', '065', '066', '068', '069', '070', '072', '074', '075', '078', '081', '084', '085', '086', '087', '088', '090', '092', '094', '102'), 4,
            if(mid(cdts, 2, 3) in ('002', '003', '012', '013', '014', '017', '018', '024', '025', '026', '028', '030', '033', '035', '039', '040', '041', '044', '051', '057', '058', '061', '067', '073', '076', '077', '079', '080', '083', '082', '091', '093', '095', '096', '097', '100'), 5,
              0))))) uicRegion,
   max(if(yrending=2001,ethW,null)) ethW01,
   max(if(yrending=2005,ethW,null)) ethW05,
   max(if(yrending=2006,ethW,null)) ethW06,
   max(if(yrending=2010,ethW,null)) ethW10,
   max(if(yrending=2014,ethW,null)) ethW14,
   max(if(yrending=2015,ethW,null)) ethW15,
   max(if(yrending=2016,ethW,null)) ethW16,
   max(if(yrending=2001,ethB,null)) ethB01,
   max(if(yrending=2005,ethB,null)) ethB05,
   max(if(yrending=2006,ethB,null)) ethB06,
   max(if(yrending=2010,ethB,null)) ethB10,
   max(if(yrending=2014,ethB,null)) ethB14,
   max(if(yrending=2015,ethB,null)) ethB15,
   max(if(yrending=2016,ethB,null)) ethB16,
   max(if(yrending=2001,ethL,null)) ethL01,
   max(if(yrending=2005,ethL,null)) ethL05,
   max(if(yrending=2006,ethL,null)) ethL06,
   max(if(yrending=2010,ethL,null)) ethL10,
   max(if(yrending=2014,ethL,null)) ethL14,
   max(if(yrending=2015,ethL,null)) ethL15,
   max(if(yrending=2016,ethL,null)) ethL16,
   max(if(yrending=2001,ethM,null)) ethM01,
   max(if(yrending=2005,ethM,null)) ethM05,
   max(if(yrending=2006,ethM,null)) ethM06,
   max(if(yrending=2010,ethM,null)) ethM10,
   max(if(yrending=2014,ethM,null)) ethM14,
   max(if(yrending=2015,ethM,null)) ethM15,
   max(if(yrending=2016,ethM,null)) ethM16,
   max(if(yrending=2001,lwIncPc,null)) lwIncPc01,
   max(if(yrending=2005,lwIncPc,null)) lwIncPc05,
   max(if(yrending=2006,lwIncPc,null)) lwIncPc06,
   max(if(yrending=2010,lwIncPc,null)) lwIncPc10,
   max(if(yrending=2014,lwIncPc,null)) lwIncPc14,
   max(if(yrending=2015,lwIncPc,null)) lwIncPc15,
   max(if(yrending=2016,lwIncPc,null)) lwIncPc16,
   max(if(yrending=2001,mobRt,null)) mobRt01,
   max(if(yrending=2005,mobRt,null)) mobRt05,
   max(if(yrending=2006,mobRt,null)) mobRt06,
   max(if(yrending=2010,mobRt,null)) mobRt10,
   max(if(yrending=2014,mobRt,null)) mobRt14,
   max(if(yrending=2015,mobRt,null)) mobRt15,
   max(if(yrending=2016,mobRt,null)) mobRt16,
   max(if(yrending=2001,LEPPc,null)) LEPPc01,
   max(if(yrending=2005,LEPPc,null)) LEPPc05,
   max(if(yrending=2006,LEPPc,null)) LEPPc06,
   max(if(yrending=2010,LEPPc,null)) LEPPc10,
   max(if(yrending=2014,LEPPc,null)) LEPPc14,
   max(if(yrending=2015,LEPPc,null)) LEPPc15,
   max(if(yrending=2016,LEPPc,null)) LEPPc16
   FROM isbe_rc
   where yrending in (2001, 2005, 2006, 2010, 2014, 2015, 2016)
   group by rc_cdts
   ) rc

   right join (
   select
   sum(if(year=2001,totalCount,null)) Count01,
   sum(if(year=2005,totalCount,null)) Count05,
   sum(if(year=2006,totalCount,null)) Count06,
   sum(if(year=2010,totalCount,null)) Count10,
   sum(if(year=2014,totalCount,null)) Count14,
   sum(if(year=2015,totalCount,null)) Count15,
   sum(if(year=2016,totalCount,null)) Count16,
   sum(if(year=2001,(q3pct+q4pct)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove50Pc01,
   sum(if(year=2005,(q3pct+q4pct)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove50Pc05,
   sum(if(year=2006,(q3pct+q4pct)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove50Pc06,
   sum(if(year=2010,(q3pct+q4pct)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove50Pc10,
   sum(if(year=2014,(q3pct+q4pct)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove50Pc14,
   sum(if(year=2015,(q3pct+q4pct)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove50Pc15,
   sum(if(year=2016,(q3pct+q4pct)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove50Pc16,
   sum(if(year=2001,(paa60)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove60Pc01,
   sum(if(year=2005,(paa60)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove60Pc05,
   sum(if(year=2006,(paa60)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove60Pc06,
   sum(if(year=2010,(paa60)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove60Pc10,
   sum(if(year=2014,(paa60)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove60Pc14,
   sum(if(year=2015,(paa60)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove60Pc15,
   sum(if(year=2016,(paa60)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove60Pc16,
   sum(if(year=2001,(paa68)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove68Pc01,
   sum(if(year=2005,(paa68)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove68Pc05,
   sum(if(year=2006,(paa68)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove68Pc06,
   sum(if(year=2010,(paa68)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove68Pc10,
   sum(if(year=2014,(paa68)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove68Pc14,
   sum(if(year=2015,(paa68)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove68Pc15,
   sum(if(year=2016,(paa68)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove68Pc16,
   sum(if(year=2001,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2001,totalCount,null)) PercentileAvg01,
   sum(if(year=2005,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2005,totalCount,null)) PercentileAvg05,
   sum(if(year=2006,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2006,totalCount,null)) PercentileAvg06,
   sum(if(year=2010,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2010,totalCount,null)) PercentileAvg10,
   sum(if(year=2014,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2014,totalCount,null)) PercentileAvg14,
   sum(if(year=2015,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2015,totalCount,null)) PercentileAvg15,
   sum(if(year=2016,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2016,totalCount,null)) PercentileAvg16,
   sum(if(year=2001,(stanine)*totalCount,null))/sum(if(year=2001,totalCount,null)) StanineAvg01,
   sum(if(year=2005,(stanine)*totalCount,null))/sum(if(year=2005,totalCount,null)) StanineAvg05,
   sum(if(year=2006,(stanine)*totalCount,null))/sum(if(year=2006,totalCount,null)) StanineAvg06,
   sum(if(year=2010,(stanine)*totalCount,null))/sum(if(year=2010,totalCount,null)) StanineAvg10,
   sum(if(year=2014,(stanine)*totalCount,null))/sum(if(year=2014,totalCount,null)) StanineAvg14,
   sum(if(year=2015,(stanine)*totalCount,null))/sum(if(year=2015,totalCount,null)) StanineAvg15,
   sum(if(year=2016,(stanine)*totalCount,null))/sum(if(year=2016,totalCount,null)) StanineAvg16,
   sum(if(year=2001,(wAvgScore)*totalCount,null))/sum(if(year=2001,totalCount,null)) ScoreAvg01,
   sum(if(year=2005,(wAvgScore)*totalCount,null))/sum(if(year=2005,totalCount,null)) ScoreAvg05,
   sum(if(year=2006,(wAvgScore)*totalCount,null))/sum(if(year=2006,totalCount,null)) ScoreAvg06,
   sum(if(year=2010,(wAvgScore)*totalCount,null))/sum(if(year=2010,totalCount,null)) ScoreAvg10,
   sum(if(year=2014,(wAvgScore)*totalCount,null))/sum(if(year=2014,totalCount,null)) ScoreAvg14,
   sum(if(year=2015,(wAvgScore)*totalCount,null))/sum(if(year=2015,totalCount,null)) ScoreAvg15,
   sum(if(year=2016,(wAvgScore)*totalCount,null))/sum(if(year=2016,totalCount,null)) ScoreAvg16,
   sum(if(year=2001,s1pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s1Avg01,
   sum(if(year=2001,s2pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s2Avg01,
   sum(if(year=2001,s3pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s3Avg01,
   sum(if(year=2001,s4pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s4Avg01,
   sum(if(year=2001,s5pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s5Avg01,
   sum(if(year=2001,s6pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s6Avg01,
   sum(if(year=2001,s7pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s7Avg01,
   sum(if(year=2001,s8pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s8Avg01,
   sum(if(year=2001,s9pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s9Avg01,
   sum(if(year=2006,s1pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s1Avg06,
   sum(if(year=2006,s2pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s2Avg06,
   sum(if(year=2006,s3pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s3Avg06,
   sum(if(year=2006,s4pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s4Avg06,
   sum(if(year=2006,s5pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s5Avg06,
   sum(if(year=2006,s6pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s6Avg06,
   sum(if(year=2006,s7pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s7Avg06,
   sum(if(year=2006,s8pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s8Avg06,
   sum(if(year=2006,s9pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s9Avg06,
   sum(if(year=2010,s1pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s1Avg10,
   sum(if(year=2010,s2pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s2Avg10,
   sum(if(year=2010,s3pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s3Avg10,
   sum(if(year=2010,s4pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s4Avg10,
   sum(if(year=2010,s5pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s5Avg10,
   sum(if(year=2010,s6pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s6Avg10,
   sum(if(year=2010,s7pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s7Avg10,
   sum(if(year=2010,s8pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s8Avg10,
   sum(if(year=2010,s9pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s9Avg10,
   sum(if(year=2016,s1pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s1Avg16,
   sum(if(year=2016,s2pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s2Avg16,
   sum(if(year=2016,s3pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s3Avg16,
   sum(if(year=2016,s4pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s4Avg16,
   sum(if(year=2016,s5pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s5Avg16,
   sum(if(year=2016,s6pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s6Avg16,
   sum(if(year=2016,s7pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s7Avg16,
   sum(if(year=2016,s8pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s8Avg16,
   sum(if(year=2016,s9pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s9Avg16,
   cdts
   from schwideComposites
   where year in (2001, 2005, 2006, 2010, 2014, 2015, 2016)
    and subj = 'Reading'
   group by cdts
   ) swc on (swc.cdts=rc.rc_cdts)
   group by uicRegion

   union

   select 'Reading' subj,
   concat(cd, 'xxxxxx') rc_cdts, 'composite' rcdts, '' scName, max(diName) diName, group_concat(distinct county) county, '' schType, group_concat(distinct region) region, group_concat(distinct countyCode) countyCode, group_concat(distinct uicRegion) uicRegion,
   sum(ethW01*Count01)/sum(Count01) ethW01,
   sum(ethW05*Count05)/sum(Count05) ethW05,
   sum(ethW06*Count06)/sum(Count06) ethW06,
   sum(ethW10*Count10)/sum(Count10) ethW10,
   sum(ethW14*Count14)/sum(Count14) ethW14,
   sum(ethW15*Count15)/sum(Count15) ethW15,
   sum(ethW16*Count16)/sum(Count16) ethW16,
   sum(ethB01*Count01)/sum(Count01) ethB01,
   sum(ethB05*Count05)/sum(Count05) ethB05,
   sum(ethB06*Count06)/sum(Count06) ethB06,
   sum(ethB10*Count10)/sum(Count10) ethB10,
   sum(ethB14*Count14)/sum(Count14) ethB14,
   sum(ethB15*Count15)/sum(Count15) ethB15,
   sum(ethB16*Count16)/sum(Count16) ethB16,
   sum(ethL01*Count01)/sum(Count01) ethL01,
   sum(ethL05*Count05)/sum(Count05) ethL05,
   sum(ethL06*Count06)/sum(Count06) ethL06,
   sum(ethL10*Count10)/sum(Count10) ethL10,
   sum(ethL14*Count14)/sum(Count14) ethL14,
   sum(ethL15*Count15)/sum(Count15) ethL15,
   sum(ethL16*Count16)/sum(Count16) ethL16,
   sum(ethM01*Count01)/sum(Count01) ethM01,
   sum(ethM05*Count05)/sum(Count05) ethM05,
   sum(ethM06*Count06)/sum(Count06) ethM06,
   sum(ethM10*Count10)/sum(Count10) ethM10,
   sum(ethM14*Count14)/sum(Count14) ethM14,
   sum(ethM15*Count15)/sum(Count15) ethM15,
   sum(ethM16*Count16)/sum(Count16) ethM16,
   sum(lwIncPc01*Count01)/sum(Count01) lwIncPc01,
   sum(lwIncPc05*Count05)/sum(Count05) lwIncPc05,
   sum(lwIncPc06*Count06)/sum(Count06) lwIncPc06,
   sum(lwIncPc10*Count10)/sum(Count10) lwIncPc10,
   sum(lwIncPc14*Count14)/sum(Count14) lwIncPc14,
   sum(lwIncPc15*Count15)/sum(Count15) lwIncPc15,
   sum(lwIncPc16*Count16)/sum(Count16) lwIncPc16,
   sum(mobRt01*Count01)/sum(Count01) mobRt01,
   sum(mobRt05*Count05)/sum(Count05) mobRt05,
   sum(mobRt06*Count06)/sum(Count06) mobRt06,
   sum(mobRt10*Count10)/sum(Count10) mobRt10,
   sum(mobRt14*Count14)/sum(Count14) mobRt14,
   sum(mobRt15*Count15)/sum(Count15) mobRt15,
   sum(mobRt16*Count16)/sum(Count16) mobRt16,
   sum(LEPPc01*Count01)/sum(Count01) LEPPc01,
   sum(LEPPc05*Count05)/sum(Count05) LEPPc05,
   sum(LEPPc06*Count06)/sum(Count06) LEPPc06,
   sum(LEPPc10*Count10)/sum(Count10) LEPPc10,
   sum(LEPPc14*Count14)/sum(Count14) LEPPc14,
   sum(LEPPc15*Count15)/sum(Count15) LEPPc15,
   sum(LEPPc16*Count16)/sum(Count16) LEPPc16,
   sum(Count01) Count01,
   sum(Count05) Count05,
   sum(Count06) Count06,
   sum(Count10) Count10,
   sum(Count14) Count14,
   sum(Count15) Count15,
   sum(Count16) Count16,
   sum(AtAbove50Pc01*Count01)/sum(Count01) AtAbove50Pc01,
   sum(AtAbove50Pc05*Count05)/sum(Count05) AtAbove50Pc05,
   sum(AtAbove50Pc06*Count06)/sum(Count06) AtAbove50Pc06,
   sum(AtAbove50Pc10*Count10)/sum(Count10) AtAbove50Pc10,
   sum(AtAbove50Pc14*Count14)/sum(Count14) AtAbove50Pc14,
   sum(AtAbove50Pc15*Count15)/sum(Count15) AtAbove50Pc15,
   sum(AtAbove50Pc16*Count16)/sum(Count16) AtAbove50Pc16,
   sum(AtAbove60Pc01*Count01)/sum(Count01) AtAbove60Pc01,
   sum(AtAbove60Pc05*Count05)/sum(Count05) AtAbove60Pc05,
   sum(AtAbove60Pc06*Count06)/sum(Count06) AtAbove60Pc06,
   sum(AtAbove60Pc10*Count10)/sum(Count10) AtAbove60Pc10,
   sum(AtAbove60Pc14*Count14)/sum(Count14) AtAbove60Pc14,
   sum(AtAbove60Pc15*Count15)/sum(Count15) AtAbove60Pc15,
   sum(AtAbove60Pc16*Count16)/sum(Count16) AtAbove60Pc16,
   sum(AtAbove68Pc01*Count01)/sum(Count01) AtAbove68Pc01,
   sum(AtAbove68Pc05*Count05)/sum(Count05) AtAbove68Pc05,
   sum(AtAbove68Pc06*Count06)/sum(Count06) AtAbove68Pc06,
   sum(AtAbove68Pc10*Count10)/sum(Count10) AtAbove68Pc10,
   sum(AtAbove68Pc14*Count14)/sum(Count14) AtAbove68Pc14,
   sum(AtAbove68Pc15*Count15)/sum(Count15) AtAbove68Pc15,
   sum(AtAbove68Pc16*Count16)/sum(Count16) AtAbove68Pc16,
   sum(PercentileAvg01*Count01)/sum(Count01) PercentileAvg01,
   sum(PercentileAvg05*Count05)/sum(Count05) PercentileAvg05,
   sum(PercentileAvg06*Count06)/sum(Count06) PercentileAvg06,
   sum(PercentileAvg10*Count10)/sum(Count10) PercentileAvg10,
   sum(PercentileAvg14*Count14)/sum(Count14) PercentileAvg14,
   sum(PercentileAvg15*Count15)/sum(Count15) PercentileAvg15,
   sum(PercentileAvg16*Count16)/sum(Count16) PercentileAvg16,
   sum(StanineAvg01*Count01)/sum(Count01) StanineAvg01,
   sum(StanineAvg05*Count05)/sum(Count05) StanineAvg05,
   sum(StanineAvg06*Count06)/sum(Count06) StanineAvg06,
   sum(StanineAvg10*Count10)/sum(Count10) StanineAvg10,
   sum(StanineAvg14*Count14)/sum(Count14) StanineAvg14,
   sum(StanineAvg15*Count15)/sum(Count15) StanineAvg15,
   sum(StanineAvg16*Count16)/sum(Count16) StanineAvg16,
   sum(ScoreAvg01*Count01)/sum(Count01) ScoreAvg01,
   sum(ScoreAvg05*Count05)/sum(Count05) ScoreAvg05,
   sum(ScoreAvg06*Count06)/sum(Count06) ScoreAvg06,
   sum(ScoreAvg10*Count10)/sum(Count10) ScoreAvg10,
   sum(ScoreAvg14*Count14)/sum(Count14) ScoreAvg14,
   sum(ScoreAvg15*Count15)/sum(Count15) ScoreAvg15,
   sum(ScoreAvg16*Count16)/sum(Count16) ScoreAvg16,
   sum(s1Avg01*Count01)/sum(Count01) s1Avg01,
   sum(s2Avg01*Count01)/sum(Count01) s2Avg01,
   sum(s3Avg01*Count01)/sum(Count01) s3Avg01,
   sum(s4Avg01*Count01)/sum(Count01) s4Avg01,
   sum(s5Avg01*Count01)/sum(Count01) s5Avg01,
   sum(s6Avg01*Count01)/sum(Count01) s6Avg01,
   sum(s7Avg01*Count01)/sum(Count01) s7Avg01,
   sum(s8Avg01*Count01)/sum(Count01) s8Avg01,
   sum(s9Avg01*Count01)/sum(Count01) s9Avg01,
   sum(s1Avg06*Count06)/sum(Count06) s1Avg06,
   sum(s2Avg06*Count06)/sum(Count06) s2Avg06,
   sum(s3Avg06*Count06)/sum(Count06) s3Avg06,
   sum(s4Avg06*Count06)/sum(Count06) s4Avg06,
   sum(s5Avg06*Count06)/sum(Count06) s5Avg06,
   sum(s6Avg06*Count06)/sum(Count06) s6Avg06,
   sum(s7Avg06*Count06)/sum(Count06) s7Avg06,
   sum(s8Avg06*Count06)/sum(Count06) s8Avg06,
   sum(s9Avg06*Count06)/sum(Count06) s9Avg06,
   sum(s1Avg10*Count10)/sum(Count10) s1Avg10,
   sum(s2Avg10*Count10)/sum(Count10) s2Avg10,
   sum(s3Avg10*Count10)/sum(Count10) s3Avg10,
   sum(s4Avg10*Count10)/sum(Count10) s4Avg10,
   sum(s5Avg10*Count10)/sum(Count10) s5Avg10,
   sum(s6Avg10*Count10)/sum(Count10) s6Avg10,
   sum(s7Avg10*Count10)/sum(Count10) s7Avg10,
   sum(s8Avg10*Count10)/sum(Count10) s8Avg10,
   sum(s9Avg10*Count10)/sum(Count10) s9Avg10,
   sum(s1Avg16*Count16)/sum(Count16) s1Avg16,
   sum(s2Avg16*Count16)/sum(Count16) s2Avg16,
   sum(s3Avg16*Count16)/sum(Count16) s3Avg16,
   sum(s4Avg16*Count16)/sum(Count16) s4Avg16,
   sum(s5Avg16*Count16)/sum(Count16) s5Avg16,
   sum(s6Avg16*Count16)/sum(Count16) s6Avg16,
   sum(s7Avg16*Count16)/sum(Count16) s7Avg16,
   sum(s8Avg16*Count16)/sum(Count16) s8Avg16,
   sum(s9Avg16*Count16)/sum(Count16) s9Avg16,
   concat(cd, 'xxxxxx') cdts
   from (
   SELECT cdts rc_cdts, max(rcdts) rcdts, max(scName) scName, max(diName) diName, max(county) county, max(schType) schType,
    left(min(rcdts),2) region, mid(max(rcdts),3,3) countyCode,
    if(cdts like 'x016299%',1,
      if(mid(cdts, 2, 3) in ('016', '022', '045', '049', '063', '099'), 2,
        if(mid(cdts, 2, 3) in ( '004', '008', '019', '043', '047', '052', '071', '089', '098', '101'), 3,
          if(mid(cdts, 2, 3) in ( '001', '005', '006', '007', '009', '010', '011', '015', '020', '021', '023', '027', '029', '031', '032', '034', '036', '037', '038', '042', '046', '048', '050', '053', '054', '055', '056', '059', '060', '062', '064', '065', '066', '068', '069', '070', '072', '074', '075', '078', '081', '084', '085', '086', '087', '088', '090', '092', '094', '102'), 4,
            if(mid(cdts, 2, 3) in ('002', '003', '012', '013', '014', '017', '018', '024', '025', '026', '028', '030', '033', '035', '039', '040', '041', '044', '051', '057', '058', '061', '067', '073', '076', '077', '079', '080', '083', '082', '091', '093', '095', '096', '097', '100'), 5,
              0))))) uicRegion,
   max(if(yrending=2001,ethW,null)) ethW01,
   max(if(yrending=2005,ethW,null)) ethW05,
   max(if(yrending=2006,ethW,null)) ethW06,
   max(if(yrending=2010,ethW,null)) ethW10,
   max(if(yrending=2014,ethW,null)) ethW14,
   max(if(yrending=2015,ethW,null)) ethW15,
   max(if(yrending=2016,ethW,null)) ethW16,
   max(if(yrending=2001,ethB,null)) ethB01,
   max(if(yrending=2005,ethB,null)) ethB05,
   max(if(yrending=2006,ethB,null)) ethB06,
   max(if(yrending=2010,ethB,null)) ethB10,
   max(if(yrending=2014,ethB,null)) ethB14,
   max(if(yrending=2015,ethB,null)) ethB15,
   max(if(yrending=2016,ethB,null)) ethB16,
   max(if(yrending=2001,ethL,null)) ethL01,
   max(if(yrending=2005,ethL,null)) ethL05,
   max(if(yrending=2006,ethL,null)) ethL06,
   max(if(yrending=2010,ethL,null)) ethL10,
   max(if(yrending=2014,ethL,null)) ethL14,
   max(if(yrending=2015,ethL,null)) ethL15,
   max(if(yrending=2016,ethL,null)) ethL16,
   max(if(yrending=2001,ethM,null)) ethM01,
   max(if(yrending=2005,ethM,null)) ethM05,
   max(if(yrending=2006,ethM,null)) ethM06,
   max(if(yrending=2010,ethM,null)) ethM10,
   max(if(yrending=2014,ethM,null)) ethM14,
   max(if(yrending=2015,ethM,null)) ethM15,
   max(if(yrending=2016,ethM,null)) ethM16,
   max(if(yrending=2001,lwIncPc,null)) lwIncPc01,
   max(if(yrending=2005,lwIncPc,null)) lwIncPc05,
   max(if(yrending=2006,lwIncPc,null)) lwIncPc06,
   max(if(yrending=2010,lwIncPc,null)) lwIncPc10,
   max(if(yrending=2014,lwIncPc,null)) lwIncPc14,
   max(if(yrending=2015,lwIncPc,null)) lwIncPc15,
   max(if(yrending=2016,lwIncPc,null)) lwIncPc16,
   max(if(yrending=2001,mobRt,null)) mobRt01,
   max(if(yrending=2005,mobRt,null)) mobRt05,
   max(if(yrending=2006,mobRt,null)) mobRt06,
   max(if(yrending=2010,mobRt,null)) mobRt10,
   max(if(yrending=2014,mobRt,null)) mobRt14,
   max(if(yrending=2015,mobRt,null)) mobRt15,
   max(if(yrending=2016,mobRt,null)) mobRt16,
   max(if(yrending=2001,LEPPc,null)) LEPPc01,
   max(if(yrending=2005,LEPPc,null)) LEPPc05,
   max(if(yrending=2006,LEPPc,null)) LEPPc06,
   max(if(yrending=2010,LEPPc,null)) LEPPc10,
   max(if(yrending=2014,LEPPc,null)) LEPPc14,
   max(if(yrending=2015,LEPPc,null)) LEPPc15,
   max(if(yrending=2016,LEPPc,null)) LEPPc16
   FROM isbe_rc
   where yrending in (2001, 2005, 2006, 2010, 2014, 2015, 2016)
   group by rc_cdts
   ) rc

   right join (
   select
   sum(if(year=2001,totalCount,null)) Count01,
   sum(if(year=2005,totalCount,null)) Count05,
   sum(if(year=2006,totalCount,null)) Count06,
   sum(if(year=2010,totalCount,null)) Count10,
   sum(if(year=2014,totalCount,null)) Count14,
   sum(if(year=2015,totalCount,null)) Count15,
   sum(if(year=2016,totalCount,null)) Count16,
   sum(if(year=2001,(q3pct+q4pct)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove50Pc01,
   sum(if(year=2005,(q3pct+q4pct)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove50Pc05,
   sum(if(year=2006,(q3pct+q4pct)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove50Pc06,
   sum(if(year=2010,(q3pct+q4pct)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove50Pc10,
   sum(if(year=2014,(q3pct+q4pct)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove50Pc14,
   sum(if(year=2015,(q3pct+q4pct)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove50Pc15,
   sum(if(year=2016,(q3pct+q4pct)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove50Pc16,
   sum(if(year=2001,(paa60)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove60Pc01,
   sum(if(year=2005,(paa60)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove60Pc05,
   sum(if(year=2006,(paa60)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove60Pc06,
   sum(if(year=2010,(paa60)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove60Pc10,
   sum(if(year=2014,(paa60)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove60Pc14,
   sum(if(year=2015,(paa60)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove60Pc15,
   sum(if(year=2016,(paa60)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove60Pc16,
   sum(if(year=2001,(paa68)*totalCount,null))/sum(if(year=2001,totalCount,null)) AtAbove68Pc01,
   sum(if(year=2005,(paa68)*totalCount,null))/sum(if(year=2005,totalCount,null)) AtAbove68Pc05,
   sum(if(year=2006,(paa68)*totalCount,null))/sum(if(year=2006,totalCount,null)) AtAbove68Pc06,
   sum(if(year=2010,(paa68)*totalCount,null))/sum(if(year=2010,totalCount,null)) AtAbove68Pc10,
   sum(if(year=2014,(paa68)*totalCount,null))/sum(if(year=2014,totalCount,null)) AtAbove68Pc14,
   sum(if(year=2015,(paa68)*totalCount,null))/sum(if(year=2015,totalCount,null)) AtAbove68Pc15,
   sum(if(year=2016,(paa68)*totalCount,null))/sum(if(year=2016,totalCount,null)) AtAbove68Pc16,
   sum(if(year=2001,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2001,totalCount,null)) PercentileAvg01,
   sum(if(year=2005,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2005,totalCount,null)) PercentileAvg05,
   sum(if(year=2006,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2006,totalCount,null)) PercentileAvg06,
   sum(if(year=2010,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2010,totalCount,null)) PercentileAvg10,
   sum(if(year=2014,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2014,totalCount,null)) PercentileAvg14,
   sum(if(year=2015,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2015,totalCount,null)) PercentileAvg15,
   sum(if(year=2016,(wAvgPercentileEquivalent)*totalCount,null))/sum(if(year=2016,totalCount,null)) PercentileAvg16,
   sum(if(year=2001,(stanine)*totalCount,null))/sum(if(year=2001,totalCount,null)) StanineAvg01,
   sum(if(year=2005,(stanine)*totalCount,null))/sum(if(year=2005,totalCount,null)) StanineAvg05,
   sum(if(year=2006,(stanine)*totalCount,null))/sum(if(year=2006,totalCount,null)) StanineAvg06,
   sum(if(year=2010,(stanine)*totalCount,null))/sum(if(year=2010,totalCount,null)) StanineAvg10,
   sum(if(year=2014,(stanine)*totalCount,null))/sum(if(year=2014,totalCount,null)) StanineAvg14,
   sum(if(year=2015,(stanine)*totalCount,null))/sum(if(year=2015,totalCount,null)) StanineAvg15,
   sum(if(year=2016,(stanine)*totalCount,null))/sum(if(year=2016,totalCount,null)) StanineAvg16,
   sum(if(year=2001,(wAvgScore)*totalCount,null))/sum(if(year=2001,totalCount,null)) ScoreAvg01,
   sum(if(year=2005,(wAvgScore)*totalCount,null))/sum(if(year=2005,totalCount,null)) ScoreAvg05,
   sum(if(year=2006,(wAvgScore)*totalCount,null))/sum(if(year=2006,totalCount,null)) ScoreAvg06,
   sum(if(year=2010,(wAvgScore)*totalCount,null))/sum(if(year=2010,totalCount,null)) ScoreAvg10,
   sum(if(year=2014,(wAvgScore)*totalCount,null))/sum(if(year=2014,totalCount,null)) ScoreAvg14,
   sum(if(year=2015,(wAvgScore)*totalCount,null))/sum(if(year=2015,totalCount,null)) ScoreAvg15,
   sum(if(year=2016,(wAvgScore)*totalCount,null))/sum(if(year=2016,totalCount,null)) ScoreAvg16,
   sum(if(year=2001,s1pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s1Avg01,
   sum(if(year=2001,s2pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s2Avg01,
   sum(if(year=2001,s3pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s3Avg01,
   sum(if(year=2001,s4pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s4Avg01,
   sum(if(year=2001,s5pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s5Avg01,
   sum(if(year=2001,s6pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s6Avg01,
   sum(if(year=2001,s7pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s7Avg01,
   sum(if(year=2001,s8pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s8Avg01,
   sum(if(year=2001,s9pct*totalCount,null))/sum(if(year=2001,totalCount,null)) s9Avg01,
   sum(if(year=2006,s1pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s1Avg06,
   sum(if(year=2006,s2pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s2Avg06,
   sum(if(year=2006,s3pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s3Avg06,
   sum(if(year=2006,s4pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s4Avg06,
   sum(if(year=2006,s5pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s5Avg06,
   sum(if(year=2006,s6pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s6Avg06,
   sum(if(year=2006,s7pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s7Avg06,
   sum(if(year=2006,s8pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s8Avg06,
   sum(if(year=2006,s9pct*totalCount,null))/sum(if(year=2006,totalCount,null)) s9Avg06,
   sum(if(year=2010,s1pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s1Avg10,
   sum(if(year=2010,s2pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s2Avg10,
   sum(if(year=2010,s3pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s3Avg10,
   sum(if(year=2010,s4pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s4Avg10,
   sum(if(year=2010,s5pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s5Avg10,
   sum(if(year=2010,s6pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s6Avg10,
   sum(if(year=2010,s7pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s7Avg10,
   sum(if(year=2010,s8pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s8Avg10,
   sum(if(year=2010,s9pct*totalCount,null))/sum(if(year=2010,totalCount,null)) s9Avg10,
   sum(if(year=2016,s1pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s1Avg16,
   sum(if(year=2016,s2pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s2Avg16,
   sum(if(year=2016,s3pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s3Avg16,
   sum(if(year=2016,s4pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s4Avg16,
   sum(if(year=2016,s5pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s5Avg16,
   sum(if(year=2016,s6pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s6Avg16,
   sum(if(year=2016,s7pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s7Avg16,
   sum(if(year=2016,s8pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s8Avg16,
   sum(if(year=2016,s9pct*totalCount,null))/sum(if(year=2016,totalCount,null)) s9Avg16,
   cdts, left(cdts, 7) cd
   from schwideComposites
   where year in (2001, 2005, 2006, 2010, 2014, 2015, 2016)
    and subj = 'Reading'
   group by cdts
   ) swc on (swc.cdts=rc.rc_cdts)
   group by cd
) z
